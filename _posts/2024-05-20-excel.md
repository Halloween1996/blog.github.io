---
layout: post
title: 认识 Microsoft Excel
date: 2024-05-20 10:42
author: Maxell
header-img: img/skating.jpeg
catalog: true
tags:
  - Office
  - Softwares
---
Excel中对单元格的引用有3种方式，分别是相对引用，绝对引用和混合引用，下面我们就结合实例，向大家一一讲解这几种引用方式。  
**1.相对引用** = 等号加上单元格, 就是随着引用单元格. 如果公式所在单元格的位置改变，引用也将随之改变，如果多行或多列地复制公式，引用会自动调整。默认情况下，新公式使用相对引用。

**2.绝对引用**  = 单元格中的绝对引用则总是在指定位置引用单元格（例如$A$3，行和列符号前边加$即表示绝对引用）。如果公式所在单元格的位置改变，绝对引用的单元格也始终保持不变，如果多行或多列地复制公式，绝对引用将不做调整。

**3.混合引用**
# Excel 日期与时间概念
**在Excel中，日期和时间是以一种特殊的数值形式存储的，这种数值形式被称作“序列值”。**
Excel中默认采用“1900年日期系统”，即以1900年1月1日作为序列值的基准日，当日的序列值为1，而1900年1月30日的序列值则为30，依次类推。

在 Excel中,可以用引号代表整体. 故此, 在计算时间的时候可以这样写:: 
- ="2024-5-14"-"2023-3-23", 得到418, 也就是两个日期相差418天
- ="2024-5-14"-16, 得到2024-4-28, 也就是16天之前是2024年的4月28日
- 当然也可以写作为:单元格-1, 这点毫无影响.
- =Today()函数自动代表今天的日期,但是不可以用作直接的运算.
- =Now()函数代表了今天的日期和现在的时间,同样是自动更新的.

**在Excel中，时间可以被看成日期的一部分，以小数形式的序列值来表示时间。**
即一天的数值单位是整数1，一天中的某一时刻就是一个小数，例如，12:00:00是一天的一半，其数值为0.5；

2021年2月26日序列值为44253，那2021年2月26日12:00:00的序列值为44253.5。

日期与时间一样可以参与数值运算，6个小时是一天的1/4，也即0.25。


# Excel函数的基本概念

函数是Excel定义好的具有特定功能的内置公式。在公式中可以直接调用这些函数，在调用的时候，一般要提供给它一些数据，即参数，函数执行之后一般给出一个结果，这个结果成为函数的返回值。
函数一般是在公式中调用的。函数以函数名称开始，后面紧跟着圆括号，圆括号中是以逗号隔开的参数。

如前面介绍的用于从身份证号码中提取员工出生日期与年龄的公式，“=YEAR(NOW())-MID(E2,7,4)”的意思是，YEAR(NOW())，year函数是返回某日期对应的年份，这里与NOW函数相结合，返回的就是当前的年份，也即2021年，MID(E2,7,4)的意思是对E2单元格中的字符串从第7位开始向后提取4位，也即提取的是1986，这样2021-1986=35岁，就计算出了员工的年龄了。

函数的参数值可以是数值、文本、单元格或单元格区域的引用地址、名称、标志和函数。有的函数不需要参数，有的则需要输入多个参数，其中有些参数是可选的。用户必须按照正确的次序和格式输入函数参数，参数无大小写之分。
# 函数的嵌套与组合

公式可以由单一函数构成，但更多的情况下，公式是由运算符、常量、单元格引用以及函数共同组成的。
在公式中最多可以包含64级嵌套函数。当函数B用做函数A的参数时，函数B称为二级函数。如果函数B 中还有函数C作为参数，则函数C称为三级函数。

例子1：
求当前学生的数学成绩与该课程的平均成绩之差:=B2-AVERAGE($B$2:$B$8)

例子2:
当学生3门课平均分低于60分时记为“不通过”，大于60时则返回3门课的总成绩
=IF(AVERAGE(B2:D2)>=60,SUM(B2:D2),"不通过")

例子3:
根据学生的平均成绩计算出每个学生的成绩等级，并填写在“总评”一栏。成绩等级的评判标准是：90分（含90分）以上为“优秀”；80-90分（含80分不含90分）为“良好”；60-80分（含60分不含80分）为“通过”，60分（不含60）一下为“不通过”。
- =IF(E2>=90,"优秀",IF(E2>=80,"良好",IF(E2>=60,"通过","不通过")))
但是我想要显示学生成绩的同时显示等级,那么我可以用&字符把不同的指令写在一起:
=E2&"分, 成绩"&IF(E2>=90,"优秀",IF(E2>=80,"良好",IF(E2>=60,"通过","不通过")))
或者:
=E2&"分, 成绩"&IF(E2>=90,"优秀",IF(E2>=80,"良好",IF(E2>=60,"通过","不通过")))&", 全班平均分为: "& ROUND(AVERAGE(E2:E159),1)

那么如果我的本意不是想调用函数,我只想要打一个空格在单元格里面,怎么办呢? 答案很简单,用分号(')告诉计算机这个就是表面意思,直接打后面的内容就行. 而这个分号告诉计算机接下来的内容并非命令, 在计算机科学的概念叫做转义符.

# 有趣的技巧: 
## Boolean Value可用作数值运算
也就是通常说的True or False, 常见于 if 判断. 通常, True =1 而 False = 0
有趣就有趣在,它这个值是可以作为一种数值来计算,例如说: SUM(“3”,2,TRUE)等于6
我觉得这点很有趣, 因为可以这么设置,当一个单元格呈现为False的时候, 我不想这一行的数据参与到总计来. 我除了改用Sumif命令以外,我还可以给那一行的进行subTotal时, 乘以 True or False, 也就是1或者0, 而如果乘以零,那么结果就是等于0.
## Sum函数不会把文本类型当作数值
Sum(A6:F6)=1? 这是因为B6单元格是文本"你好"，**C6虽然是数字，但是文本格式的数字,所以不算数值**，D6是空白单元格，只有E6单元格中的1被SUM函数计算了，因此返回值是1。

**如何给单元格添加一条斜线或者一个交叉, 以表达出"禁止输入"的意思?**
对着想要禁止输入的单元格, 按快捷键Ctrl + 1,或者鼠标右键,选择"设置单元格格式"

Excel 自带函数太多了, 怎么找到相关的函数呢?
可以查阅: [表头斜线怎么绘制你会吗？我们有3种方法 - 知乎](https://zhuanlan.zhihu.com/p/365194136)

# 常见的函数简介
## 数值函数

| 数值  | 函数     |         |                     |       |       |          |          |
| --- | ------ | ------- | ------------------- | ----- | ----- | -------- | -------- |
| 日期  | =Today | =Now    | =Month              | =Day  | =Year | =Weekday | =Workday |
| 时间  | =Hour  | =Second | =NOW()-TRUNC(NOW()) | =Time |       |          |          |
| 转换  | =Text  |         |                     |       |       |          |          |
| 计算  | =Days  | =Abs    | =Sumproduct         |       |       |          |          |
|     | 计算日期差距 | 绝对值     | 返回相应的数组或区域乘积的和      |       |       |          |          |

**text函数的功能是把数值转换为自己想要的文本格式**
text的语法格式=text(value,format_text）Value为数字值，Format_text为设置单元格格式中自己所要选用的文本格式。

## 统计函数

| 统计                         | 函数       |            |             |
| -------------------------- | -------- | ---------- | ----------- |
| 框选列里的最大数,最小数,中间数           | =MAX,    | =MIN       | =MEDIAN     |
| 逻辑判断,如果...则相加              | =SUMIF   | =SUMIFS    |             |
| 符合条件的平均数                   | =AVERAGE | =AverageIF | =AverageIFS |
| 最基本的逻辑命令                   | =IF      | =IFS       | =AND        |
| 开关函数                       | =Switch  |            |             |
| 计算指定范围内有几个符合条件的**数字**的单元格  | =Count   | =CountIF   | =CountifS   |
| 计算指定范围内有几个符合条件的**非空值**的单元格 | =Counta  |            |             |
| 排名                         | =Rank    |            |             |

### COUNT函数 于 COUNTA 函数 的区别
如果参数直接是**数字、空白单元格、逻辑值、日期或文本数字，执行时都可以被计算**，而非数字的**文本或错误值**都将**被忽略**；如果参数是单元格或区域的引用，则只统计引用中的数字、日期值，引用中的空白单元格、逻辑值、文字或错误值都将被忽略。如果需要统计逻辑值、文字或错误值，则使用COUNTA函数。

### Switch 函数
功能: 指定一个单元格, 如果单元格符合value 1, 那就显示result 1, 如此类推
格式: SWITCH(_expression_, _value1_, _result1_, \[default or value2, result2],…\[default or value3, result3])
这个功能我If也能做啊? 是, 但是用if 来写就很长, Switch 就相对短一些.Switch函数必须精准,不能指定一个范围.就例如上面的那个给不同分数,基于不同评价的例子来说:
它只能写成 =Switch(E2,90,"优秀",80,"良好",60,"合格"). 在这个公式里下, 88分就拿不到任何评价. 
而不是: =Switch(E2,>90,"优秀",>80,"良好">,60,"合格"), 会报错.
### Rank 排名函数
**功能：** 返回一个数字在数字列表中的排名。数字的排名是其大小与列表中其他值的比值，如果列表已排过序，则数字的排名就是它当前的位置。RANK函数属于统计函数。

**格式：** RANK(number, ref, order)

**参数：** 3个参数:

参数1：number，需要找到排名的数字

参数2：ref，为数字列表数组或对数字列表的引用。ref中的非数值型参数将被忽略

参数3：order，为一个数字，指明排名的方式。Order为0或省略时，对数字的排名是按照降序排列的；不为0，则是按照升序排列

注意，函数RANK对重复值的排名相同，如90分是第3名，87分是第4名，但有2个90分的同学，那他俩都是第3名，87分的同学就是第5名了。

**rank函数对不连续单元格排名**：不连续的单元格，第二个参数需要用括号和逗号形式连接起来。例子: “=RANK(B15,(B15,B19,B23,B27),0)”

## 常用的字符操作函数

| 字符操作               | 函数           |              |      |
| ------------------ | ------------ | ------------ | ---- |
| 替换单元格里的特定字符        | =SUBSTITUTE  |              |      |
| 将多个单元格的值合并为一个单元格。  | =CONCATENATE |              |      |
| 计算两个日期之间的日历天数。     | =DAYS        | =NETWORKDAYS |      |
| 返回从单元格最左\右边开始的字符数。 | =LEFT        | =RIGHT       | =MID |
| 取整函数               | =INT         | =Round       |      |
| 显示字符串中的字符数。        | =LEN         |              |      |
| 删除开头的空格的或透明字符。     | =TRIM        |              |      |
| 删除单元格中所有非打印字符      | =CLEAN       |              |      |

### 取整函数: INT (非四舍五入) 与 Round (四舍五入)
INT返回参数取整处理的整数值。无论参数是正数还是负数，INT函数总是将要处理数取整为小于等于它的最大整数。INT函数属于数学与三角函数.
**格式：** INT (number)
**参数：** 只有一个参数number，需要进行取整处理的实数。
例如：看一下INT函数的基础功能演示

INT(1.9)=1
INT(-1.9)=-2

ROUND返回某个数字按指定位数四舍五入后的数字。ROUND函数属于数学与三角函数
**格式：** ROUND（number，num_digits）
**参数：** 两个参数。
第一个参数number：需要进行四舍五入处理的数字

第二个参数num_digits：指定的舍入位数，均为整数（……，-2,-1,0,1,2，……）

如果num_digits大于0，则舍入到指定的小数位

如果num_digits等于0，则摄入到最接近的整数

如果num_digits小于0，则在整数位即小数点左侧进行四舍五入。

num_digits是负几，就对整数从又向左的第几位进行舍入。

请看演示：

ROUND(3.15,1)返回3.2，函数作用为将3.15四舍五入到小数点后1位

ROUND(3.148,1)返回3.1，函数作用为将3.148四舍五入到小数点后1位

ROUND(-3.148,2)返回-3.15，函数作用为将-3.148四舍五入到小数点后2位

**ROUND(1.9,-1)返回0**，函数作用为将1.9四舍五入到小数点前1位，也即对1进行四舍五入，请与下边这2个例子对比来看

**ROUND(5.9,-1)返回10**，函数作用为将5.9四舍五入到小数点前1位，对个位数5进行四舍五入，所以返回值为10

**ROUND(481.89,-2)返回500**，函数作用为将481.89四舍五入到小数点前2位，也即对十位数8进行四舍五入，所以返回值为500

Int 函数的参考链接: [取整函数的规则不是四舍五入 - 知乎](https://zhuanlan.zhihu.com/p/360716151)
Round 函数的参考链接: [可以按指定位数完成四舍五入的函数-舍入函数 - 知乎](https://zhuanlan.zhihu.com/p/361010842)
### **LEFT/RIGHT/MID**等函数用于从文本中提取部分字符
其中，LEFT函数表示从左向右取；RIGHT函数表示从右向左取；MID函数也是从左向右提取，但不一定是从第一个字符起始，可以从中间开始。

**LEFT/RIGHT函数的语法格式都是(text,num_chars)**

其中text指文本，是从中提取字符的长字符串，参数num_chars是想要提取的字符个数。

例如我们有如下的原始数据，但是现在他是字符和数字的组合，现在我们想把原始数据前5个数字单独提取出来使用，这时我们就可以用LEFT函数来帮助我们实现这个想法。=LEFT(B2,5)这个公式就表示，将B2这个单元格中的字符串，从第一个位置开始，从左向右取5个出来。

**MID函数的语法格式为MID(text,start_num,num_chars)**
参数text的属性与前面两个函数相同，参数start_num是要提取的开始字符，参数num_chars是要提取的字符个数。
例如我们只需要提取5位数字的最后两位，那么我们可以做如下操作。=MID(B2,4,2)这个公式就表示，将B2单元格的字符串，从第4位开始，提取2个长度的字符出来。

### LEN函数的功能是返回文本字符串的字符数
此函数用于双字节字符，且空格也将作为字符进行统计。LEN函数的语法格式为LEN(text)。参数text为要查找器长度的文本。

参考链接: [还不会用Excel公式提取字符串里的有用信息吧？ - 知乎](https://zhuanlan.zhihu.com/p/358817910)

## 查找函数

| 查找                 | 函数       |          |
| ------------------ | -------- | -------- |
| 查表,并偏移多少行\\ 列并返回   | =VLookUP | =HLookUP |
|                    | 纵向偏移查表   | 横向偏移查表   |
| 返回最符合查找值的**单元格**位置 | =FIND    | =Search  |
|                    | 不支持通配符   | 支持通配符    |
| 返回最符合查找值的**行列**位置  | =Match   |          |


### VLookup函数 - 纵向查表
**功能：** 在制定单元格区域的首列中查找指定的值，并返回该值所在行内制定列好的单元格的值，也称为纵向查表函数。VLOOKUP函数属于查找与引用函数

**格式：** VLOOKUP(lookup_value,table_array,col_index_num,range_lookup)

**参数：** 4个参数，VLOOKUP(查找值，查找范围，查找列数，精确匹配或者近似匹配)

例子:

|      | A    | B    | C   | D   | E   | F   | G    |
| ---- | ---- | ---- | --- | --- | --- | --- | ---- |
| 1    | 学号   | 姓名   | 语文  | 数学  | 总分  |     | 学号11 |
| .... |      |      |     |     |     |     | 学号37 |
| 59   | 学号59 | 测试59 | 78  | 95  | 173 |     |      |

我想要查询学号37的学生总分是多少.那我可以这么写:
“=VLOOKUP(G2,$A$2`:` $E$59,5,FALSE)”，返回值为166，即学号37学生对应的总分数

**公式的含义：**

1.“G2”查找值，在指定的单元格区域的**首列**中查找的值，本例中就是$A$2:$E$59范围，首列就是A列，也即要查找的是A列中与G2单元格内容相匹配的值，所以VLOOKUP函数也称为纵向查表函数。

2.“$A$2:$E$59”查找范围，这里为什么要用绝对引用呢，因为通过绝对引用后，可以对公式进行下拉，这样统计其他学号的总分就不用重复输入函数，下拉即可，因为其他学号的总分，也是在这个范围内进行查找。

3.“5”，这里的数字5是代表需要返回值所在的列数，引用范围是“$A$2:$E$59”所以A列是第1列，B列是第二列，以此类推，“总分”所在的列是第5列，倘若引用是从B列开始，那这个位置就是数字4，**注意这里的列数是从引用范围的第一列做为1**，而不是A列。

4.“FALSE” 查找方式为精确匹配或者模糊匹配，0或FALSE为精确匹配，TRUE为模糊匹配

这个公式通俗的讲就是对H2单元格中的学号在A列中查找他所在的行，找到这一行以后，就将这一行第6列的值返回，这个过程中是精确匹配的，必须严格一致。
参考链接: [有4个参数的查找函数(VLOOKUP)，那也没必要害怕 - 知乎](https://zhuanlan.zhihu.com/p/362422173)

### Match函数
match的作用是：返回指定数值在指定数组区域中的位置
参数: Match(lookup_Value,Lookup_array,match_type)
lookup_value：需要在数据表（lookup_array）中查找的值。可以为数值（数字、文本或逻辑值）或对数字、文本或逻辑值的单元格引用。也可以使用通配符
lookup_array：要搜索的单元格的区域
match_type：表示查询的指定方式，用数字-1、0或者1表示.

使用 **MATCH** 函数在 范围 单元格中搜索特定的项，然后返回该项在此区域中的相对位置。 例如，如果 A1:A6 区域中包含值 5, 25 , 38, 25, 11, 15，那么公式 **=MATCH(25,A1:A3,0)** 返回数字 2，因为第一个 25 是该区域中的第二项。